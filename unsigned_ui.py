# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'untitled.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication, QWidget
from PyQt5.QtWidgets import QVBoxLayout, QLabel
from PyQt5.QtGui import QFont
from PyQt5.QtCore import QTimer, QTime, Qt
from PyQt5.QtWidgets import QMainWindow
'''
  Config:
  - Normal Small Blind value
  - Normal Small Blind step
  - Normal Level Time period
  - Heads Up Small Blind value
  - Heads Up Small Blind step
  - Heads Up Level Time period
'''

class Ui_Dialog(QMainWindow):
  def __init__(self, level_period_m=12, small_blind_step=100):

    super().__init__()

    # self.gridLayout

    # exit()

    # return - works

    self.level_period = [level_period_m, 0]
    self.m = level_period_m
    self.s = 0
    self.l = 1
    self.sb = small_blind_step
    self.sec_cnt = 0
    self.time_step_ms = 100

    self.setObjectName("MainWindow")
    self.resize(1920, 1080)
    self.gridLayout = QtWidgets.QGridLayout(self)
    # self.gridLayout =
    self.gridLayout.setObjectName("gridLayout")
    self.label = QtWidgets.QLabel(self)
    # return - works
    self.label.setSizeIncrement(QtCore.QSize(5, 5))
    font = QtGui.QFont()
    font.setPointSize(256)
    font.setBold(True)
    font.setWeight(75)
    self.label.setFont(font)
    self.label.setLayoutDirection(QtCore.Qt.LeftToRight)
    self.label.setAutoFillBackground(True)
    self.label.setScaledContents(True)
    self.label.setAlignment(QtCore.Qt.AlignCenter)
    self.label.setObjectName("label")
    self.gridLayout.addWidget(self.label, 0, 0, 1, 2)
    self.label_2 = QtWidgets.QLabel(self)

    font = QtGui.QFont()
    font.setPointSize(200)
    font.setBold(True)
    font.setWeight(75)
    self.label_2.setFont(font)
    self.label_2.setAutoFillBackground(True)
    self.label_2.setLineWidth(2)
    self.label_2.setScaledContents(True)
    self.label_2.setAlignment(QtCore.Qt.AlignCenter)
    self.label_2.setObjectName("label_2")
    self.gridLayout.addWidget(self.label_2, 1, 0, 1, 2)
    self.pushButton_3 = QtWidgets.QPushButton(self)
    sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
    sizePolicy.setHorizontalStretch(0)
    sizePolicy.setVerticalStretch(0)
    sizePolicy.setHeightForWidth(self.pushButton_3.sizePolicy().hasHeightForWidth())
    self.pushButton_3.setSizePolicy(sizePolicy)
    font = QtGui.QFont()
    font.setPointSize(64)
    font.setBold(True)
    self.pushButton_3.setFont(font)
    self.pushButton_3.setObjectName("pushButton_3")
    self.gridLayout.addWidget(self.pushButton_3, 2, 0, 1, 1)
    self.pushButton_2 = QtWidgets.QPushButton(self)
    sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
    sizePolicy.setHorizontalStretch(0)
    sizePolicy.setVerticalStretch(0)
    sizePolicy.setHeightForWidth(self.pushButton_2.sizePolicy().hasHeightForWidth())
    self.pushButton_2.setSizePolicy(sizePolicy)
    font = QtGui.QFont()
    font.setPointSize(64)
    font.setBold(True)
    self.pushButton_2.setFont(font)
    self.pushButton_2.setLayoutDirection(QtCore.Qt.LeftToRight)
    self.pushButton_2.setObjectName("pushButton_2")
    self.gridLayout.addWidget(self.pushButton_2, 2, 1, 1, 1)
    self.pushButton = QtWidgets.QPushButton(self)
    sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
    sizePolicy.setHorizontalStretch(0)
    sizePolicy.setVerticalStretch(0)
    sizePolicy.setHeightForWidth(self.pushButton.sizePolicy().hasHeightForWidth())
    self.pushButton.setSizePolicy(sizePolicy)
    font = QtGui.QFont()
    font.setPointSize(64)
    font.setBold(True)
    self.pushButton.setFont(font)
    self.pushButton.setObjectName("pushButton")
    self.gridLayout.addWidget(self.pushButton, 3, 0, 1, 2)
    self.actionPrevLevel = QtWidgets.QAction(self)
    self.actionPrevLevel.setObjectName("actionPrevLevel")
    self.actionNextLevel = QtWidgets.QAction(self)
    self.actionNextLevel.setObjectName("actionNextLevel")
    self.actionHeadsUp = QtWidgets.QAction(self)
    self.actionHeadsUp.setObjectName("actionHeadsUp")

    widget = QWidget()
    widget.setLayout(self.gridLayout)
    self.setCentralWidget(widget)

    self.retranslateUi()
    self.pushButton_2.clicked.connect(self.next_level_button_action) # type: ignore
    self.pushButton_3.clicked.connect(self.prev_level_button_action) # type: ignore
    self.pushButton.clicked.connect(self.headsup_button_action) # type: ignore

    QtCore.QMetaObject.connectSlotsByName(self)

    # TIMER EVENT
    timer = QTimer(self.gridLayout)
    timer.timeout.connect(self.showTime)
    timer.start(self.time_step_ms)

    # RESIZE EVENT
    self.resizeEvent = self.customResizeEvent

  def customResizeEvent(self, event):
    self.updateFonts()

  def timetime(self, l, m, s):
    if m == 0 and s == 0:
      return l+1, *self.level_period
    if s == 0:
      return l, m-1, 59
    return l, m, s-1

  # method called by timer
  def showTime(self):
    self.sec_cnt += self.time_step_ms
    if self.sec_cnt == 1000:
      self.sec_cnt = 0
      self.l, self.m, self.s = self.timetime(self.l, self.m, self.s)
    # self.label_3.setText(f"L:{self.l}")
    self.label.setText(f"{self.m}:{self.s : 03d}")
    self.label_2.setText(f"L{self.l} | {self.l * self.sb}/{self.l * self.sb * 2}")

  def next_level_button_action(self):
    self.l += 1
    self.m, self.s = self.level_period

  def prev_level_button_action(self):
    self.l -= 1
    self.m, self.s = self.level_period

  def headsup_button_action(self):
    self.l = 1
    self.m, self.s = 10, 0
    self.sb = 1000

  def reset_button_action(self):
    self.l = 1
    self.m, self.s = self.level_period
    self.sb = 100

  def updateFonts(self):
    # Calculate font sizes based on window width and height
    width = self.width()
    font_size_1 = int(width / 10)
    font_size_2 = int(width / 20)
    font_size_3 = int(width / 30)

    # Update font sizes
    font = self.label.font()
    font.setPointSize(font_size_1)
    self.label.setFont(font)

    font = self.label_2.font()
    font.setPointSize(font_size_2)
    self.label_2.setFont(font)

    font = self.pushButton_2.font()
    font.setPointSize(font_size_3)
    self.pushButton_2.setFont(font)

    font = self.pushButton_3.font()
    font.setPointSize(font_size_3)
    self.pushButton_3.setFont(font)

    font = self.pushButton.font()
    font.setPointSize(font_size_3)
    self.pushButton.setFont(font)

  def retranslateUi(self):
    _translate = QtCore.QCoreApplication.translate
    self.setWindowTitle(_translate("MainWindow", "PokerTimer"))
    self.label.setText(_translate("MainWindow", "TextLabel"))
    self.label_2.setText(_translate("MainWindow", "TextLabel"))
    self.pushButton_3.setText(_translate("MainWindow", "<-"))
    self.pushButton_2.setText(_translate("MainWindow", "->"))
    self.pushButton.setText(_translate("MainWindow", "HeadsUp"))
    self.actionPrevLevel.setText(_translate("MainWindow", "PrevLevel"))
    self.actionNextLevel.setText(_translate("MainWindow", "NextLevel"))
    self.actionNextLevel.setToolTip(_translate("MainWindow", "NextLevel"))
    self.actionHeadsUp.setText(_translate("MainWindow", "HeadsUp"))


if __name__ == "__main__":
  import sys
  app = QtWidgets.QApplication(sys.argv)
  ui = Ui_Dialog()
  ui.show()
  sys.exit(app.exec_())
